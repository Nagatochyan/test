parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"UvW9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r={RGBToHSV:function(r,t,o){var a,u,n,d,e=Math.max(r,t,o),h=Math.min(r,t,o);r===t&&r===o?a=0:(r>=t&&r>=o?(u=0,n=t,d=o):t>=r&&t>=o?(u=120,n=o,d=r):(u=240,n=r,d=t),(a=Math.round((n-d)/(e-h)*60+u))<0&&(a+=360));return{h:a,s:Math.round((e-h)/e*255),v:e}},HSVToRGB:function(r,t,o){var a=o,u=Math.round(a-t/255*a);return r<60?{r:a,g:Math.round(r/60*(a-u)+u),b:u}:r<120?{r:Math.round((120-r)/60*(a-u)+u),g:a,b:u}:r<180?{r:u,g:a,b:Math.round((r-120)/60*(a-u)+u)}:r<240?{r:u,g:Math.round((240-r)/60*(a-u)+u),b:a}:r<300?{r:Math.round((r-240)/60*(a-u)+u),g:u,b:a}:r<360?{r:a,g:u,b:Math.round((360-r)/60*(a-u)+u)}:void 0}},t=r;exports.default=t;
},{}],"nzUD":[function(require,module,exports) {
var define;
var global = arguments[3];
var e,t=arguments[3];function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(i){if("object"===("undefined"==typeof exports?"undefined":n(exports))&&"undefined"!=typeof module)module.exports=i();else if("function"==typeof e&&e.amd)e([],i);else{("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this).GIF=i()}}(function(){return function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return r(n||e)},f,f.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,i){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function s(e){return"function"==typeof e}function o(e){return"object"===n(e)&&null!==e}function a(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,i,r,h,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}if(a(n=this._events[e]))return!1;if(s(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),n.apply(this,r)}else if(o(n))for(r=Array.prototype.slice.call(arguments,1),i=(l=n.slice()).length,h=0;h<i;h++)l[h].apply(this,r);return!0},r.prototype.addListener=function(e,t){var n;if(!s(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,s(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(n=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!s(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},r.prototype.removeListener=function(e,t){var n,i,r,a;if(!s(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=(n=this._events[e]).length,i=-1,n===t||s(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(a=r;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(s(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?s(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(s(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t,n){var i,r,s,o,a;a=navigator.userAgent.toLowerCase(),o=navigator.platform.toLowerCase(),s="ie"===(i=a.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0])[1]&&document.documentMode,(r={name:"version"===i[1]?i[3]:i[1],version:s||parseFloat("opera"===i[1]&&i[4]?i[4]:i[2]),platform:{name:a.match(/ip(?:ad|od|hone)/)?"ios":(a.match(/(?:webos|android)/)||o.match(/mac|win|linux/)||["other"])[0]}})[r.name]=!0,r[r.name+parseInt(r.version,10)]=!0,r.platform[r.platform.name]=!0,t.exports=r},{}],3:[function(e,t,n){var i,r,s,o={}.hasOwnProperty,a=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},h=[].slice;i=e("events").EventEmitter,s=e("./browser.coffee"),r=function(e){var t,n;function r(e){var n,i,r;for(i in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(e),t)r=t[i],null==(n=this.options)[i]&&(n[i]=r)}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,i),t={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},n={delay:500,copy:!1},r.prototype.setOption=function(e,t){if(this.options[e]=t,null!=this._canvas&&("width"===e||"height"===e))return this._canvas[e]=t},r.prototype.setOptions=function(e){var t,n,i;for(t in n=[],e)o.call(e,t)&&(i=e[t],n.push(this.setOption(t,i)));return n},r.prototype.addFrame=function(e,t){var i,r;for(r in null==t&&(t={}),(i={}).transparent=this.options.transparent,n)i[r]=t[r]||n[r];if(null==this.options.width&&this.setOption("width",e.width),null==this.options.height&&this.setOption("height",e.height),"undefined"!=typeof ImageData&&null!==ImageData&&e instanceof ImageData)i.data=e.data;else if("undefined"!=typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&e instanceof CanvasRenderingContext2D||"undefined"!=typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&e instanceof WebGLRenderingContext)t.copy?i.data=this.getContextData(e):i.context=e;else{if(null==e.childNodes)throw new Error("Invalid image");t.copy?i.data=this.getImageData(e):i.image=e}return this.frames.push(i)},r.prototype.render=function(){var e,t,n;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var e,t,n;for(n=[],e=0,t=this.frames.length;0<=t?e<t:e>t;0<=t?++e:--e)n.push(null);return n}.call(this),t=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(e=0,n=t;0<=n?e<n:e>n;0<=n?++e:--e)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},r.prototype.abort=function(){for(var e;null!=(e=this.activeWorkers.shift());)this.log("killing active worker"),e.terminate();return this.running=!1,this.emit("abort")},r.prototype.spawnWorkers=function(){var e,t,n,i;return e=Math.min(this.options.workers,this.frames.length),function(){n=[];for(var i=t=this.freeWorkers.length;t<=e?i<e:i>e;t<=e?i++:i--)n.push(i);return n}.apply(this).forEach((i=this,function(e){var t;return i.log("spawning worker "+e),(t=new Worker(i.options.workerScript)).onmessage=function(e){return i.activeWorkers.splice(i.activeWorkers.indexOf(t),1),i.freeWorkers.push(t),i.frameFinished(e.data)},i.freeWorkers.push(t)})),e},r.prototype.frameFinished=function(e){var t,n;if(this.log("frame "+e.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[e.index]=e,!0===this.options.globalPalette&&(this.options.globalPalette=e.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(t=1,n=this.freeWorkers.length;1<=n?t<n:t>n;1<=n?++t:--t)this.renderNextFrame();return a.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},r.prototype.finishRendering=function(){var e,t,n,i,r,s,o,a,h,l,f,u,p,c,d,v;for(a=0,r=0,h=(c=this.imageParts).length;r<h;r++)a+=((t=c[r]).data.length-1)*t.pageSize+t.cursor;for(a+=t.pageSize-t.cursor,this.log("rendering finished - filesize "+Math.round(a/1e3)+"kb"),e=new Uint8Array(a),u=0,s=0,l=(d=this.imageParts).length;s<l;s++)for(n=o=0,f=(v=(t=d[s]).data).length;o<f;n=++o)p=v[n],e.set(p,u),n===t.data.length-1?u+=t.cursor:u+=t.pageSize;return i=new Blob([e],{type:"image/gif"}),this.emit("finished",i,e)},r.prototype.renderNextFrame=function(){var e,t,n;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return e=this.frames[this.nextFrame++],n=this.freeWorkers.shift(),t=this.getTask(e),this.log("starting frame "+(t.index+1)+" of "+this.frames.length),this.activeWorkers.push(n),n.postMessage(t)},r.prototype.getContextData=function(e){return e.getImageData(0,0,this.options.width,this.options.height).data},r.prototype.getImageData=function(e){var t;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),(t=this._canvas.getContext("2d")).setFill=this.options.background,t.fillRect(0,0,this.options.width,this.options.height),t.drawImage(e,0,0),this.getContextData(t)},r.prototype.getTask=function(e){var t,n;if(n={index:t=this.frames.indexOf(e),last:t===this.frames.length-1,delay:e.delay,transparent:e.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:"chrome"===s.name},null!=e.data)n.data=e.data;else if(null!=e.context)n.data=this.getContextData(e.context);else{if(null==e.image)throw new Error("Invalid frame");n.data=this.getImageData(e.image)}return n},r.prototype.log=function(){var e;if(e=1<=arguments.length?h.call(arguments,0):[],this.options.debug)return console.log.apply(console,e)},r}(),t.exports=r},{"./browser.coffee":2,events:1}]},{},[3])(3)});
},{}],"QdeU":[function(require,module,exports) {
"use strict";var e=d(require("./imgproc.js")),t=d(require("./gif"));function d(e){return e&&e.__esModule?e:{default:e}}window.onload=function(){var d,a,n=document.getElementById("modal"),i=document.getElementById("result-container"),r=0,l=!1,c=null,o=document.getElementById("canvas"),h=o.getContext("2d");document.getElementById("file-image").addEventListener("change",function(g){if(!l){var u=g.target.files;if(0!==u.length)if(-1!==String(u[0].type).indexOf("image"))if(u[0].size>2e5)alert("サイズが200KB以下の画像ファイルを指定して下さい。");else{i.removeChild(i.firstChild),document.getElementById("progress").value=0,n.classList.remove("hidden"),document.getElementById("btn-save-image").classList.add("hidden");var s=new FileReader;s.readAsDataURL(u[0]),s.onload=function(){var g=new Image;g.src=s.result,g.onload=function(){r=0,c=m(),(d=new t.default({quality:1,workers:5,width:g.width,height:g.height,workerScript:"/gif.worker.js",transparent:c,dither:!1})).on("finished",function(e){var t=new Image;t.src=URL.createObjectURL(e),i.appendChild(t),l=!1,a=e,n.classList.add("hidden"),document.getElementById("btn-save-image").classList.remove("hidden")}),l=!0,o.width=g.width,o.height=g.height,h.fillStyle="rgba(255, 255, 255, 255)",h.fillRect(0,0,o.width,o.height),function t(a){if(l&&0==r)h.drawImage(a,0,0,o.width,o.height);else{for(var n=h.getImageData(0,0,o.width,o.height),i=h.createImageData(o.width,o.height),c=0;c<o.height;c++)for(var m=0;m<o.width;m++){var g=n.data[4*m+c*n.width*4],u=n.data[1+4*m+c*n.width*4],s=n.data[2+4*m+c*n.width*4],f=n.data[3+4*m+c*n.width*4],w=e.default.RGBToHSV(g,u,s);w.h+=12,w.h>=360&&(w.h-=360);var v=e.default.HSVToRGB(w.h,w.s,w.v);i.data[4*m+c*i.width*4]=v.r,i.data[1+4*m+c*i.width*4]=v.g,i.data[2+4*m+c*i.width*4]=v.b,i.data[3+4*m+c*i.width*4]=f}h.putImageData(i,0,0)}l&&(d.addFrame(h,{delay:20,copy:!0}),r++,document.getElementById("progress").value=r,30==r)?d.render():requestAnimationFrame(t)}(g)}}}else alert("画像ファイルを指定して下さい。")}}),document.getElementById("btn-load-image").addEventListener("click",function(e){document.getElementById("file-image").click()}),document.getElementById("btn-save-image").addEventListener("click",function(e){var t=document.createElement("a");t.download="gaming.gif",t.href=URL.createObjectURL(a),t.click()});var m=function(){return document.getElementById("white").checked?document.getElementById("white").value:document.getElementById("black").checked?document.getElementById("black").value:null}};
},{"./imgproc.js":"UvW9","./gif":"nzUD"}]},{},["QdeU"], null)
